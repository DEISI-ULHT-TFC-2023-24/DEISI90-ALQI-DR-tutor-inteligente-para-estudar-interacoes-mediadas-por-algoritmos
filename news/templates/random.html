{% extends 'layout.html' %}


{% block style %}


{% endblock style %}

{% block content %}
    <div class="container2" style="width: 100%; margin-top: 13%">
        <a style="text-decoration: none" href="{{ obj.content_url }}">
            <div class="flex-container" style="flex-direction: column">
                <div class="container" style="flex-grow: 1">
                    <h2 style="margin-bottom: 5%">
                        {{ obj.content_headline }}
                    </h2>
                    <img src="{{ obj.content_image }}" alt="Image" style="width: 350px; height: 192px;">
                    <div style="margin: 5%">
                        {{ obj.content_text }}
                    </div>
                    <h4>
                        {{ obj.content_date }}
                    </h4>
                    <div style="float: right">
                        Fonte: {{ obj.content_source }}
                    </div>
                </div>
                <div style="height: 20px"></div>
            </div>
        </a>

        <div class="flex-container" style="flex-direction: column">
            <div class="container" id="text-container" style="flex-grow: 1">
                <h3>Generated by AI:</h3>
                {% if thread_news %}
                    <div id="full-content" style="display: none;">{{ thread_news }}</div>
                    <div id="visible-content" style="margin: 5%"></div>
                    <button id="show-more-btn">Mostrar mais</button>
                    <button style="margin-left: 10%; margin-right: 10%" onclick="window.location.href='{% url 'random_news' %}'">Outra coisa</button>
                    <button onclick="window.location.href='{% url 'index' %}'">Voltar</button>
                {% else %}
                    <h2>No content, yet!</h2>
                    <button style="margin-left: 10%; margin-right: 10%" onclick="window.location.href='{% url 'random_news' %}'">Outra coisa</button>
                    <button onclick="window.location.href='{% url 'index' %}'">Voltar</button>
                {% endif %}
            </div>
            <div style="height: 20px"></div>
        </div>


    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fullContentElement = document.getElementById('full-content');
            const visibleContentElement = document.getElementById('visible-content');
            const showMoreBtn = document.getElementById('show-more-btn');

            if (!fullContentElement || !visibleContentElement || !showMoreBtn) {
                console.error("Required elements not found in the DOM.");
                return;
            }

            const fullText = fullContentElement.innerText.trim();
            const initialLength = 100;
            const incrementLength = 100;
            let currentLength = initialLength;

            function getWords(text, numWords) {
                return text.split(' ').slice(0, numWords).join(' ');
            }

            function updateVisibleContent() {
                visibleContentElement.innerText = getWords(fullText, currentLength);

                if (currentLength >= fullText.split(' ').length) {
                    showMoreBtn.innerText = "Não há mais conteúdo para mostrar";
                    showMoreBtn.disabled = true;
                }
            }

            const showMore = function () {
                currentLength += incrementLength;
                updateVisibleContent();
            };

            updateVisibleContent();

            showMoreBtn.addEventListener('click', showMore);
        });
    </script>

{% endblock content %}